name: CI Build do Projeto PIM

on:
  push:
    branches: [ main, master ] # Aciona o workflow em push para as branches main ou master
  pull_request:
    branches: [ main, master ] # Aciona o workflow em pull request para as branches main ou master

jobs:
  build:
    runs-on: ubuntu-latest # O ambiente onde o workflow será executado

    steps:
    - uses: actions/checkout@v4 # Faz o checkout do seu código no runner

    - name: Setup .NET SDK
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '8.0.x' # <-- IMPORTANTE: AJUSTE AQUI a versão do .NET que seu projeto utiliza (ex: '6.0.x', '7.0.x', '8.0.x')

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20.x' # <-- IMPORTANTE: AJUSTE AQUI a versão do Node.js que seu projeto utiliza (ex: '18.x', '20.x')

    - name: Restaurar Dependências e Construir Backend (C# ASP.NET Core)
      run: |
        # O projeto backend estará em 'backend/HelpDesk.Api/HelpDesk.Api.csproj'
        dotnet restore backend/HelpDesk.Api/HelpDesk.Api.csproj
        dotnet build backend/HelpDesk.Api/HelpDesk.Api.csproj --no-restore --configuration Release

    - name: Restaurar Dependências e Construir Frontend Web (HTML/CSS/JS)
      run: |
        cd frontend-web
        # Assume-se que o projeto web está diretamente na pasta 'frontend-web'
        npm install # Ou yarn install, pnpm install
        npm run build # Ou yarn build, pnpm build

    - name: Restaurar Dependências Frontend Mobile (C# .NET MAUI)
      run: |
        # O projeto mobile estará em 'frontend-mobile/HelpDesk.Mobile/HelpDesk.Mobile.csproj'
        dotnet restore frontend-mobile/HelpDesk.Mobile/HelpDesk.Mobile.csproj

    - name: Restaurar Dependências Frontend Desktop (C# Windows Forms)
      run: |
        # O projeto desktop estará em 'frontend-desktop/HelpDesk.Desktop/HelpDesk.Desktop.csproj'
        dotnet restore frontend-desktop/HelpDesk.Desktop/HelpDesk.Desktop.csproj

    # Você pode adicionar mais passos aqui, como rodar testes, análise de código, etc.
